如何评价 angular 2 中的 AoT？  

作者：汪志成
链接：https://www.zhihu.com/question/53434390/answer/135067354
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

【相比于 JIT 有何优缺点，对于打包文件大小和渲染性能到底提升有多大 ？】

JiT是下载完整个模板之后在浏览器中解析模板并动态生成用来渲染的代码（编译），因此用到哪个模板就会编译哪个模板，这就是JIT的含义，只是一个更大粒度上的JIT，本质上这里用这个概念并无不妥，只是未必每个人都能抽象到这一层而已。而AoT是把这个过程改在编译期完成，浏览器下载到的直接就是编译好的渲染代码，下载完就会立刻开始创建DOM节点。  
因此，从这种差异就可以推断出：  
1. 首屏渲染速度会明显快于JiT，文件越大越多的项目差异越明显。  
2. 它不需要自带compiler模块，因此节省了空间。  
3. 它编译生成的代码里有大量诸如createElement之类的函数调用，因此普通的js minify工具是无法压缩它们的，生成的代码量可能比JiT还要大。不过gzip可以完美的处理这种情况，因此如果要部署AoT的成果，请务必开启gzip。  

不过，要注意提高首屏加载速度并不是AoT的首要目标，使用服务端渲染技术（Universal）才是首选方案。它的提速效果基本上是不受JiT和AoT影响的。  

文件大小方面，我做过一个具有内核、表单、HTTP这几个模块的试验性应用，aot+tree shaking+minify+gzip后大约是80k左右，只用到内核的是50k，况且以后再加载时还能缓存。所以，除非在特殊场景，否则以现在的网速通常是不用在乎这点大小的 —— 想想你的一张banner有多大。  

【内部如何实现的，貌似现在只支持 ts ？】  

你放弃了ts的同时就已经放弃了很多，与放弃的那些好处相比，不支持AoT真的只是小事一桩…… 如果希望提高加载速度，那么建议使用服务端渲染。  

【其他阵营的 React 和 Vue 是否有希望实现该功能 ？】  

对它们还不够了解，不发表评论。不过要注意你需要的未必是功能，而是要解决某些特定的需求，不要把实现方式误以为需求。只要能满足你的需求，无论用什么方式来实现都没问题。技术选型时，永远记住要从需求出发。   

以下是相关截图，来源于：https://www.zhihu.com/question/53434390  
![](asserts/angularaotscreenshot1.png)  
